<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì„±ê±´ê°• ìê°€ì§„ë‹¨ ê²€ì‚¬</title>
    <!-- EmailJS ì§ì ‘ ë¡œë“œ -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
        // EmailJS ì´ˆê¸°í™”ëŠ” ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ í›„ ìë™ìœ¼ë¡œ
        window.addEventListener('load', function() {
            if (typeof emailjs !== 'undefined') {
                try {
                    emailjs.init("sU-ufg53yRT5YLRdB");
                    console.log('EmailJS ì´ˆê¸°í™” ì„±ê³µ');
                } catch (e) {
                    console.error('EmailJS ì´ˆê¸°í™” ì‹¤íŒ¨:', e);
                }
            } else {
                console.warn('EmailJSë¥¼ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. CDN ì—°ê²°ì„ í™•ì¸í•˜ì„¸ìš”.');
            }
        });
    </script>
    <style>
        /* CSS ë³€ìˆ˜ë¡œ ìƒ‰ìƒ ê´€ë¦¬ - ì‰½ê²Œ ìˆ˜ì • ê°€ëŠ¥ */
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --success-color: #27ae60;
            --info-color: #3498db;
            --light-bg: #f5f5f5;
            --white: #ffffff;
            --text-dark: #333333;
            --text-light: #666666;
            --border-color: #ddd;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background-color: var(--light-bg);
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        /* ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .section {
            background: var(--white);
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: none;
            animation: fadeIn 0.3s ease-in;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ì œëª© ìŠ¤íƒ€ì¼ */
        h1 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 30px;
            font-size: 28px;
        }

        h2 {
            color: var(--text-dark);
            margin-bottom: 20px;
            font-size: 22px;
        }

        h3 {
            color: var(--text-dark);
            margin-bottom: 15px;
            font-size: 18px;
        }

        /* ì†Œê°œ ë°•ìŠ¤ */
        .intro-box {
            background: #f8f9fa;
            border-left: 4px solid var(--primary-color);
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .intro-box h3 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        /* ë¬¸í•­ ìŠ¤íƒ€ì¼ */
        .question-container {
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .question-number {
            color: var(--primary-color);
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 18px;
        }

        .question-text {
            font-size: 18px;
            margin-bottom: 30px;
            line-height: 1.8;
        }

        /* ëˆ„ë½ëœ ë¬¸í•­ ìŠ¤íƒ€ì¼ */
        .missing {
            border: 2px solid var(--danger-color) !important;
            background-color: #ffe6e6 !important;
        }

        .missing-indicator {
            color: var(--danger-color);
            font-weight: bold;
            margin-bottom: 10px;
            display: none;
        }

        .missing .missing-indicator {
            display: block;
        }

        /* ë¼ë””ì˜¤ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
        }

        .radio-item {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            background: #f8f9fa;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .radio-item:hover {
            background: #e9ecef;
            border-color: var(--primary-color);
        }

        .radio-item input[type="radio"] {
            margin-right: 15px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .radio-item label {
            cursor: pointer;
            font-size: 16px;
            flex: 1;
        }

        .radio-item input[type="radio"]:checked + label {
            font-weight: bold;
            color: var(--primary-color);
        }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            justify-content: space-between;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background: #229954;
        }

        /* ì²´í¬ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
        .checkbox-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .checkbox-item input[type="checkbox"] {
            margin-right: 15px;
            margin-left: 0px;
            margin-top: 3px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        /* ê²°ê³¼ ìŠ¤íƒ€ì¼ */
        .result-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .result-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .result-icon {
            font-size: 30px;
            margin-right: 15px;
        }

        /* ì²™ë„ ê·¸ë˜í”„ */
        .scale-item {
            margin-bottom: 20px;
        }

        .scale-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .scale-name {
            font-weight: bold;
        }

        .scale-score {
            font-weight: bold;
        }

        .scale-bar-container {
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }

        .scale-bar {
            height: 100%;
            transition: width 1s ease-out;
            border-radius: 15px;
        }

        .scale-bar.good { background: var(--success-color); }
        .scale-bar.caution { background: var(--warning-color); }
        .scale-bar.warning { background: #ff6b6b; }
        .scale-bar.danger { background: var(--danger-color); }

        /* íŠ¹ë³„ê´€ì°°ì˜ì—­ */
        .special-observation {
            background: #fff3cd;
            border: 1px solid #ffeeba;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .special-observation h3 {
            color: #856404;
            margin-bottom: 15px;
        }

        .observation-item {
            margin-bottom: 15px;
            padding: 10px;
            background: white;
            border-radius: 5px;
        }

        .observation-type {
            font-weight: bold;
            color: #856404;
            margin-bottom: 5px;
        }

        /* ì´ë©”ì¼ ì…ë ¥ */
        .email-section {
            background: #e3f2fd;
            border-radius: 8px;
            padding: 20px;
            margin-top: 30px;
        }

        .email-input {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 16px;
            margin-bottom: 15px;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 600px) {
            .container {
                padding: 10px;
            }

            .section {
                padding: 20px;
            }

            .radio-item {
                padding: 12px 15px;
            }

            .btn {
                padding: 10px 20px;
                font-size: 14px;
            }
        }

        /* ì•Œë¦¼ ë©”ì‹œì§€ */
        .alert {
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }

        .alert.show {
            display: block;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .alert-danger {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        /* ë¡œë”© ìŠ¤í”¼ë„ˆ */
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ê²€ì‚¬ ì†Œê°œ -->
        <div class="section active" id="intro-section">
            <h1>ì„±ê±´ê°• ìê°€ì§„ë‹¨ ê²€ì‚¬</h1>
            <div class="intro-box">
                <p>ë³¸ ê²€ì‚¬ëŠ” ì—¬ëŸ¬ë¶„ì˜ ì„±ê±´ê°• ìˆ˜ì¤€ì„ í™•ì¸í•˜ëŠ” ìê°€ì§„ë‹¨ ë„êµ¬ì…ë‹ˆë‹¤.</p>
            </div>

            <div class="intro-box">
                <h3>ğŸ“‹ ì‘ë‹µ ë°©ë²•</h3>
                <ul>
                    <li>ê° ë¬¸í•­ì„ ì½ê³  ìì‹ ì—ê²Œ í•´ë‹¹í•˜ëŠ” ì •ë„ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</li>
                    <li>ì •ë‹µì´ ì—†ìœ¼ë‹ˆ ì†”ì§í•˜ê²Œ ì‘ë‹µí•´ì£¼ì„¸ìš”</li>
                    <li>ë„ˆë¬´ ì˜¤ë˜ ê³ ë¯¼í•˜ê¸°ë³´ë‹¤, ë– ì˜¤ë¥´ëŠ” ì²« ëŠë‚Œìœ¼ë¡œ ì‘ë‹µí•´ì£¼ì„¸ìš”</li>
                </ul>
            </div>

            <div class="intro-box">
                <h3>ğŸ“Š ê²°ê³¼ ì œê³µ</h3>
                <ul>
                    <li>ê²€ì‚¬ ì™„ë£Œ í›„ 6ê°œ ì˜ì—­ë³„ ê²°ê³¼ë¥¼ ì œê³µí•©ë‹ˆë‹¤</li>
                    <li>í˜„ì¬ëŠ” íŒŒì¼ëŸ¿ ì—°êµ¬ ì¤‘ì´ë©°, ì—¬ëŸ¬ë¶„ì˜ ì°¸ì—¬ê°€ í•œêµ­í˜• ê¸°ì¤€ ë§ˆë ¨ì— ë„ì›€ì´ ë©ë‹ˆë‹¤</li>
                    <li>ì´ ê²€ì‚¬ëŠ” ìê¸°ì´í•´ë¥¼ ë•ëŠ” ì°¸ê³ ìë£Œì´ë©°, ì§„ë‹¨ì„œë‚˜ ì˜í•™ì  íŒë‹¨ì„ ìœ„í•œ ë„êµ¬ëŠ” ì•„ë‹™ë‹ˆë‹¤</li>
                    <li>ì´ë©”ì¼ ì…ë ¥ ì‹œ ìƒì„¸ ê²°ê³¼ì§€ë¥¼ ë°œì†¡í•´ë“œë¦½ë‹ˆë‹¤ (ì„ íƒ)</li>
                </ul>
            </div>

            <div class="intro-box">
                <p>â€» ëª¨ë“  ì‘ë‹µì€ ìµëª…ìœ¼ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤.<br>
                â€» ë§Œ 19ì„¸ ì´ìƒë§Œ ì°¸ì—¬ ê°€ëŠ¥í•©ë‹ˆë‹¤.<br>
                â€» ì•½ 15ë¶„ ì •ë„ ì†Œìš”ë©ë‹ˆë‹¤.<br>
                <span style="color: #e74c3c;">â€» í˜„ì¬ í™˜ê²½ì—ì„œëŠ” ì„ì‹œì €ì¥ì´ ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í•œ ë²ˆì— ì™„ë£Œí•´ì£¼ì„¸ìš”.</span></p>
            </div>

            <button class="btn btn-primary" onclick="nextSection()">ê²€ì‚¬ ì‹œì‘í•˜ê¸°</button>
        </div>

        <!-- ê°œì¸ì •ë³´ ë™ì˜ -->
        <div class="section" id="consent-section">
            <h2>ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš© ë™ì˜</h2>
            
            <div class="checkbox-item">
                <input type="checkbox" id="consent1" name="consent1">
                <label for="consent1">ë³¸ ê²€ì‚¬ì˜ ê²°ê³¼ëŠ” ì—°êµ¬ ëª©ì ìœ¼ë¡œë§Œ ì‚¬ìš©ë˜ë©°, ê°œì¸ì •ë³´ëŠ” ì•ˆì „í•˜ê²Œ ë³´í˜¸ë¨ì„ ì´í•´í–ˆìŠµë‹ˆë‹¤.</label>
            </div>

            <div class="checkbox-item">
                <input type="checkbox" id="consent2" name="consent2">
                <label for="consent2">ë§Œ 19ì„¸ ì´ìƒì„ì„ í™•ì¸í•©ë‹ˆë‹¤.</label>
            </div>

            <div class="checkbox-item">
                <input type="checkbox" id="consent3" name="consent3">
                <label for="consent3">ê²€ì‚¬ ì°¸ì—¬ì— ìë°œì ìœ¼ë¡œ ë™ì˜í•©ë‹ˆë‹¤.</label>
            </div>

            <div class="alert alert-danger" id="consent-alert">
                ëª¨ë“  í•­ëª©ì— ë™ì˜í•´ì£¼ì„¸ìš”.
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="previousSection()">ì´ì „</button>
                <button class="btn btn-primary" onclick="checkConsent()">ë‹¤ìŒ</button>
            </div>
        </div>

        <!-- ì¸êµ¬í†µê³„ (ì„±ë³„, ì—°ë ¹) -->
        <div class="section" id="demo1-section">
            <h2>ê¸°ë³¸ ì •ë³´</h2>
            
            <div class="question-container">
                <h3>ì„±ë³„</h3>
                <div class="radio-group">
                    <div class="radio-item">
                        <input type="radio" id="gender1" name="gender" value="ë‚¨ì„±">
                        <label for="gender1">ë‚¨ì„±</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="gender2" name="gender" value="ì—¬ì„±">
                        <label for="gender2">ì—¬ì„±</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="gender3" name="gender" value="ê¸°íƒ€">
                        <label for="gender3">ê¸°íƒ€</label>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="previousSection()">ì´ì „</button>
            </div>
        </div>

        <div class="section" id="demo2-section">
            <h2>ê¸°ë³¸ ì •ë³´</h2>
            
            <div class="question-container">
                <h3>ì—°ë ¹</h3>
                <div class="radio-group">
                    <div class="radio-item">
                        <input type="radio" id="age1" name="age" value="19-24ì„¸">
                        <label for="age1">19-24ì„¸</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="age2" name="age" value="25-29ì„¸">
                        <label for="age2">25-29ì„¸</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="age3" name="age" value="30-34ì„¸">
                        <label for="age3">30-34ì„¸</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="age4" name="age" value="35-39ì„¸">
                        <label for="age4">35-39ì„¸</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="age5" name="age" value="40-44ì„¸">
                        <label for="age5">40-44ì„¸</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="age6" name="age" value="45-49ì„¸">
                        <label for="age6">45-49ì„¸</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="age7" name="age" value="50-59ì„¸">
                        <label for="age7">50-59ì„¸</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="age8" name="age" value="60ì„¸ ì´ìƒ">
                        <label for="age8">60ì„¸ ì´ìƒ</label>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="previousSection()">ì´ì „</button>
            </div>
        </div>

        <!-- ê²€ì‚¬ ë¬¸í•­ë“¤ (ë™ì ìœ¼ë¡œ ìƒì„±) -->
        <div id="question-sections"></div>

        <!-- ë‚˜ë¨¸ì§€ ì¸êµ¬í†µê³„ -->
        <div class="section" id="demo3-section">
            <h2>ì¶”ê°€ ì •ë³´</h2>
            
            <div class="question-container">
                <h3>ê²°í˜¼ ìƒíƒœ</h3>
                <div class="radio-group">
                    <div class="radio-item">
                        <input type="radio" id="marriage1" name="marriage" value="ë¯¸í˜¼">
                        <label for="marriage1">ë¯¸í˜¼</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="marriage2" name="marriage" value="ê¸°í˜¼">
                        <label for="marriage2">ê¸°í˜¼</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="marriage3" name="marriage" value="ì´í˜¼Â·ë³„ê±°">
                        <label for="marriage3">ì´í˜¼Â·ë³„ê±°</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="marriage4" name="marriage" value="ì‚¬ë³„">
                        <label for="marriage4">ì‚¬ë³„</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="marriage5" name="marriage" value="ë™ê±° ì¤‘">
                        <label for="marriage5">ë™ê±° ì¤‘</label>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="previousSection()">ì´ì „</button>
            </div>
        </div>

        <div class="section" id="demo4-section">
            <h2>ì¶”ê°€ ì •ë³´</h2>
            
            <div class="question-container">
                <h3>ì—°ì•  ê´€ê³„</h3>
                <div class="radio-group">
                    <div class="radio-item">
                        <input type="radio" id="relationship1" name="relationship" value="í˜„ì¬ ì—°ì•  ì¤‘">
                        <label for="relationship1">í˜„ì¬ ì—°ì•  ì¤‘</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="relationship2" name="relationship" value="í˜„ì¬ ì—°ì• í•˜ê³  ìˆì§€ ì•ŠìŒ">
                        <label for="relationship2">í˜„ì¬ ì—°ì• í•˜ê³  ìˆì§€ ì•ŠìŒ</label>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="previousSection()">ì´ì „</button>
            </div>
        </div>

        <div class="section" id="demo5-section">
            <h2>ì¶”ê°€ ì •ë³´</h2>
            
            <div class="question-container">
                <h3>ìµœì¢… í•™ë ¥</h3>
                <div class="radio-group">
                    <div class="radio-item">
                        <input type="radio" id="education1" name="education" value="ê³ ì¡¸ ì´í•˜">
                        <label for="education1">ê³ ì¡¸ ì´í•˜</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="education2" name="education" value="ëŒ€í•™ ì¬í•™">
                        <label for="education2">ëŒ€í•™ ì¬í•™</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="education3" name="education" value="ëŒ€í•™ ì¡¸ì—…">
                        <label for="education3">ëŒ€í•™ ì¡¸ì—…</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="education4" name="education" value="ëŒ€í•™ì› ì´ìƒ">
                        <label for="education4">ëŒ€í•™ì› ì´ìƒ</label>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="previousSection()">ì´ì „</button>
            </div>
        </div>

        <div class="section" id="demo6-section">
            <h2>ì¶”ê°€ ì •ë³´</h2>
            
            <div class="question-container">
                <h3>ì§ì—… ìƒíƒœ</h3>
                <div class="radio-group">
                    <div class="radio-item">
                        <input type="radio" id="job1" name="job" value="í•™ìƒ">
                        <label for="job1">í•™ìƒ</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="job2" name="job" value="ì§ì¥ì¸">
                        <label for="job2">ì§ì¥ì¸</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="job3" name="job" value="í”„ë¦¬ëœì„œÂ·ìì˜ì—…ì">
                        <label for="job3">í”„ë¦¬ëœì„œÂ·ìì˜ì—…ì</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="job4" name="job" value="ë¬´ì§">
                        <label for="job4">ë¬´ì§</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="job5" name="job" value="ê¸°íƒ€">
                        <label for="job5">ê¸°íƒ€</label>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="previousSection()">ì´ì „</button>
            </div>
        </div>

        <div class="section" id="demo7-section">
            <h2>ì¶”ê°€ ì •ë³´</h2>
            
            <div class="question-container">
                <h3>ì„±ì  ì§€í–¥ì„±</h3>
                <div class="radio-group">
                    <div class="radio-item">
                        <input type="radio" id="orientation1" name="orientation" value="ì´ì„±ì• ì">
                        <label for="orientation1">ì´ì„±ì• ì</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="orientation2" name="orientation" value="ë™ì„±ì• ì">
                        <label for="orientation2">ë™ì„±ì• ì</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="orientation3" name="orientation" value="ì–‘ì„±ì• ì">
                        <label for="orientation3">ì–‘ì„±ì• ì</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="orientation4" name="orientation" value="ë¬´ì„±ì• ì">
                        <label for="orientation4">ë¬´ì„±ì• ì</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="orientation5" name="orientation" value="ê¸°íƒ€">
                        <label for="orientation5">ê¸°íƒ€</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="orientation6" name="orientation" value="ë°íˆê³  ì‹¶ì§€ ì•ŠìŒ">
                        <label for="orientation6">ë°íˆê³  ì‹¶ì§€ ì•ŠìŒ</label>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="previousSection()">ì´ì „</button>
            </div>
        </div>

        <div class="section" id="demo8-section">
            <h2>ì¶”ê°€ ì •ë³´</h2>
            
            <div class="question-container">
                <h3>ì„± ê´€ë ¨ ì „ë¬¸ ìƒë‹´ì„ ë°›ì•„ë³¸ ê²½í—˜ì´ ìˆìŠµë‹ˆê¹Œ?</h3>
                <div class="radio-group">
                    <div class="radio-item">
                        <input type="radio" id="counseling1" name="counseling" value="ì—†ìŒ">
                        <label for="counseling1">ì—†ìŒ</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="counseling2" name="counseling" value="ìˆìŒ">
                        <label for="counseling2">ìˆìŒ</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="counseling3" name="counseling" value="ë°íˆê³  ì‹¶ì§€ ì•ŠìŒ">
                        <label for="counseling3">ë°íˆê³  ì‹¶ì§€ ì•ŠìŒ</label>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="previousSection()">ì´ì „</button>
                <button class="btn btn-success" onclick="checkCompletion()">ê²€ì‚¬ ì™„ë£Œ</button>
            </div>
        </div>

        <!-- ê²°ê³¼ ì„¹ì…˜ -->
        <div class="section" id="result-section">
            <h1>ê²€ì‚¬ ê²°ê³¼</h1>
            
            <!-- ì¢…í•© í‰ê°€ -->
            <div class="result-section" id="overall-result">
                <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
            </div>

            <!-- ì²™ë„ë³„ ì ìˆ˜ -->
            <div class="result-section">
                <h2>ì˜ì—­ë³„ ìƒì„¸ ê²°ê³¼</h2>
                <div id="scale-results">
                    <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                </div>
            </div>

            <!-- íŠ¹ë³„ ê´€ì°° ì˜ì—­ -->
            <div class="special-observation" id="special-observation" style="display: none;">
                <h3>ã€íŠ¹ë³„ ê´€ì°° ì˜ì—­ã€‘</h3>
                <div id="observation-content">
                    <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                </div>
            </div>

            <!-- ì´ë©”ì¼ ì „ì†¡ -->
            <div class="email-section">
                <h3>ìƒì„¸ ê²°ê³¼ ë°›ê¸°</h3>
                <p>ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì‹œë©´ ë” ìì„¸í•œ í•´ì„ê³¼ ë§ì¶¤í˜• ì¡°ì–¸ì„ ë³´ë‚´ë“œë¦½ë‹ˆë‹¤.</p>
                <input type="email" class="email-input" id="email-input" placeholder="ì´ë©”ì¼ ì£¼ì†Œ ì…ë ¥">
                <button class="btn btn-primary" onclick="sendDetailedResult()">ìƒì„¸ ê²°ê³¼ ë°›ê¸°</button>
                <div class="loading" id="email-loading">
                    <div class="spinner"></div>
                    <p>ì „ì†¡ ì¤‘...</p>
                </div>
                <div class="alert alert-success" id="email-success">
                    ì´ë©”ì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤. ë°›ì€ í¸ì§€í•¨ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
                </div>
                <div class="alert alert-danger" id="email-error">
                    ì´ë©”ì¼ ì „ì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="location.reload()">ì²˜ìŒë¶€í„° ë‹¤ì‹œ</button>
                <button class="btn btn-info" onclick="downloadResults()" style="background: #17a2b8; color: white;">ê²°ê³¼ ë‹¤ìš´ë¡œë“œ</button>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let currentSection = 0;
        let answers = {};
        let sectionOrder = [];
        let lastScaleScores = {};  // ê²°ê³¼ ì €ì¥ìš©
        
        // ê²€ì‚¬ ë¬¸í•­ ë°ì´í„°
        const questions = [
            { num: 1, category: "ì„±ì  ìƒìƒì˜ ëª°ì…ë„", text: "í•˜ë£¨ì—ë„ ì—¬ëŸ¬ ë²ˆ ì„±ì  ìƒìƒì— ë¹ ì§„ë‹¤" },
            { num: 2, category: "ì„±ì¸ì‹ ì™œê³¡", text: "ìˆ ì— ì·¨í•œ ìƒíƒœì—ì„œì˜ ë™ì˜ë„ ì„±ê´€ê³„ì— ì¶©ë¶„í•œ ë™ì˜ë¡œ ë³¼ ìˆ˜ ìˆë‹¤." },
            { num: 3, category: "ì„±ì  ê´€ì‹¬ì˜ íŠ¹ì´ì„±", text: "ì¼ë°˜ì ì¸ ì„±ì  ìƒí™©ì—ì„œëŠ” í¥ë¶„ì„ ëŠë¼ê¸° ì–´ë µë‹¤" },
            { num: 4, category: "ì‚¬íšŒì  ë°”ëŒì§ì„±", text: "ë‚˜ëŠ” í•œ ë²ˆë„ ê±°ì§“ë§ì„ í•œ ì ì´ ì—†ë‹¤" },
            { num: 5, category: "ì„±ì¶©ë™ ì¡°ì ˆ ì–´ë ¤ì›€", text: "ê°‘ìê¸° ê°•í•œ ì„±ì  ì¶©ë™ì´ ì¼ì–´ë‚˜ ì œì–´í•˜ê¸° ì–´ë ¤ìš¸ ë•Œê°€ ìˆë‹¤" },
            { num: 6, category: "í™˜ìƒ-í˜„ì‹¤ ê²½ê³„ ëª¨í˜¸ì„±", text: "ì„±ì  í™˜ìƒì„ ì‹¤ì œë¡œ ì‹¤í–‰í•´ë„ ë¬¸ì œë˜ì§€ ì•ŠëŠ”ë‹¤ê³  ìƒê°í•œë‹¤" },
            { num: 7, category: "ì„±ì  ì±…ì„ê° ë¶€ì¡±", text: "ì„±ì  í–‰ë™ì˜ ì±…ì„ì€ ê¼­ ë‚´ê°€ ë‹¤ ì§ˆ í•„ìš”ëŠ” ì—†ë‹¤" },
            { num: 8, category: "ì„±ì  ìƒìƒì˜ ëª°ì…ë„", text: "ì„±ì  ìƒìƒì„ ì‹œì‘í•˜ë©´ ì˜¤ë˜ ì§€ì†ëœë‹¤" },
            { num: 9, category: "ì„±ì  ê´€ì‹¬ì˜ íŠ¹ì´ì„±", text: "íŠ¹ì •í•œ ìƒí™©ì´ë‚˜ ì¡°ê±´ì´ ìˆì–´ì•¼ ì„±ì  ë§Œì¡±ì„ ëŠë‚€ë‹¤" },
            { num: 10, category: "ì„±ì¸ì‹ ì™œê³¡", text: "ì„±ê´€ê³„ë¥¼ ì‹œì‘í–ˆë‹¤ë©´ ì¤‘ê°„ì— ë©ˆì¶”ëŠ” ê²ƒì€ ì˜³ì§€ ì•Šë‹¤." },
            { num: 11, category: "ì„±ì¶©ë™ ì¡°ì ˆ ì–´ë ¤ì›€", text: "ì„±ì¶©ë™ì„ ëŠë¼ë©´ ê³„íšì— ì—†ë˜ ì„±ì  í–‰ë™ì„ í•˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤" },
            { num: 12, category: "ì‚¬íšŒì  ë°”ëŒì§ì„±", text: "ë‚˜ëŠ” ë¶€ì ì ˆí•œ ì„±ì  ìƒìƒì„ í•œ ì ì´ ì—†ë‹¤" },
            { num: 13, category: "í™˜ìƒ-í˜„ì‹¤ ê²½ê³„ ëª¨í˜¸ì„±", text: "ê°€ë” ì„±ì  í™˜ìƒì´ í˜„ì‹¤ì²˜ëŸ¼ ëŠê»´ì§„ë‹¤" },
            { num: 14, category: "ì„±ì  ì±…ì„ê° ë¶€ì¡±", text: "ë•Œë¡œëŠ” ëª…ì‹œì  ë™ì˜ ì—†ì´ë„ ìƒëŒ€ë°©ì´ ì›í•œë‹¤ê³  í™•ì‹ í•  ìˆ˜ ìˆë‹¤" },
            { num: 15, category: "ì£¼ì˜ì ê²€", text: "ì´ ë¬¸í•­ì€ í™•ì¸ìš©ì…ë‹ˆë‹¤. 'ë³´í†µì´ë‹¤'ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”", checkValue: 3 },
            { num: 16, category: "ì„±ì  ìƒìƒì˜ ëª°ì…ë„", text: "ì¼ì´ë‚˜ ê³µë¶€ ì¤‘ì—ë„ ì„±ì  ìƒìƒì´ ë– ì˜¤ë¥¸ë‹¤" },
            { num: 17, category: "ì„±ì¸ì‹ ì™œê³¡", text: "ë…¸ì¶œì´ ì‹¬í•œ ì˜·ì„ ì…ìœ¼ë©´ ì„±ì  ì ‘ê·¼ì„ ì–´ëŠ ì •ë„ ì˜ˆìƒí•´ì•¼ í•œë‹¤" },
            { num: 18, category: "ì„±ì  ê´€ì‹¬ì˜ íŠ¹ì´ì„±", text: "ì„±ì ìœ¼ë¡œ í¥ë¶„í•˜ê¸° ìœ„í•´ ì ì  ë” ìƒˆë¡œìš´ ìê·¹ì´ í•„ìš”í•˜ë‹¤" },
            { num: 19, category: "ì„±ì¶©ë™ ì¡°ì ˆ ì–´ë ¤ì›€", text: "ì¶©ë™ì  ì„±í–‰ë™ í›„ ìì£¼ í›„íšŒí•œë‹¤" },
            { num: 20, category: "ì‚¬íšŒì  ë°”ëŒì§ì„±", text: "ë‚˜ëŠ” í•­ìƒ ë‚´ ê°ì •ì„ ì™„ë²½í•˜ê²Œ í†µì œí•œë‹¤" },
            { num: 21, category: "í™˜ìƒ-í˜„ì‹¤ ê²½ê³„ ëª¨í˜¸ì„±", text: "ì„±ì  í™˜ìƒì„ êµ¬ì²´ì ìœ¼ë¡œ ê³„íší•´ë³¸ ì ì´ ìˆë‹¤" },
            { num: 22, category: "ì„±ì  ì±…ì„ê° ë¶€ì¡±", text: "ì„±ì  í–‰ë™ì´ ë²•ì ìœ¼ë¡œ ë¬¸ì œ ë  ê±°ë¼ê³ ëŠ” ì˜ ìƒê°í•˜ì§€ ì•ŠëŠ”ë‹¤" },
            { num: 23, category: "ì„±ì  ìƒìƒì˜ ëª°ì…ë„", text: "ì„±ì  ìƒìƒì„ ë©ˆì¶”ë ¤ í•´ë„ ì˜ ë˜ì§€ ì•ŠëŠ”ë‹¤" },
            { num: 24, category: "ì„±ì¸ì‹ ì™œê³¡", text: "ì¹œì ˆí•œ íƒœë„ëŠ” ì„±ì  ê´€ì‹¬ì˜ í‘œí˜„ì¼ ìˆ˜ ìˆë‹¤" },
            { num: 25, category: "ì„±ì  ê´€ì‹¬ì˜ íŠ¹ì´ì„±", text: "ë‚´ ì„±ì  ì·¨í–¥ì„ ë‹¤ë¥¸ ì‚¬ëŒì€ ì´í•´í•˜ê¸° ì–´ë ¤ìš¸ ê²ƒì´ë‹¤" },
            { num: 26, category: "ì„±ì¶©ë™ ì¡°ì ˆ ì–´ë ¤ì›€", text: "ì„±ì ì¸ ì¶©ë™ì„ ì°¸ìœ¼ë©´ ì •ì„œì ìœ¼ë¡œ ê´´ë¡­ë‹¤" },
            { num: 27, category: "ì‚¬íšŒì  ë°”ëŒì§ì„±", text: "ë‚˜ëŠ” ì„±ì ì¸ ì¶©ë™ì„ ì–¸ì œë‚˜ ì‰½ê²Œ ì–µì œí•  ìˆ˜ ìˆë‹¤" },
            { num: 28, category: "í™˜ìƒ-í˜„ì‹¤ ê²½ê³„ ëª¨í˜¸ì„±", text: "ì„±ì  í™˜ìƒì„ ì‹¤í–‰í–ˆì„ ë•Œì˜ ê²°ê³¼ë¥¼ ì œëŒ€ë¡œ ìƒê°í•˜ì§€ ì•ŠëŠ”ë‹¤" },
            { num: 29, category: "ì„±ì  ì±…ì„ê° ë¶€ì¡±", text: "ì„±ì  í–‰ë™ì€ ì˜³ê³  ê·¸ë¦„ì˜ ë¬¸ì œë¼ê¸°ë³´ë‹¤ëŠ” ê°œì¸ ì„ íƒì´ë¼ê³  ìƒê°í•œë‹¤" },
            { num: 30, category: "ì„±ì  ìƒìƒì˜ ëª°ì…ë„", text: "ì„±ì  í™˜ìƒì´ ì¼ìƒìƒí™œì´ë‚˜ ì—…ë¬´ì— ë°©í•´ê°€ ëœë‹¤" },
            { num: 31, category: "ì„±ì¸ì‹ ì™œê³¡", text: "ì—°ì¸ ì‚¬ì´ë¼ë©´ ì„±ê´€ê³„ëŠ” ë‹¹ì—°í•œ ê²ƒì´ë‹¤" },
            { num: 32, category: "ì„±ì  ê´€ì‹¬ì˜ íŠ¹ì´ì„±", text: "íŠ¹ì • ë¬¼ê±´, ë³µì¥, ì‹ ì²´ ë¶€ìœ„ì— ê°•í•œ ì„±ì  í¥ë¯¸ë¥¼ ëŠë‚€ë‹¤" },
            { num: 33, category: "ì„±ì¶©ë™ ì¡°ì ˆ ì–´ë ¤ì›€", text: "ê°ì •ì ìœ¼ë¡œ ë¶ˆì•ˆí•  ë•Œ ì„±ì¶©ë™ì´ ë” ê°•í•´ì§„ë‹¤" },
            { num: 34, category: "ì‚¬íšŒì  ë°”ëŒì§ì„±", text: "ë‹¤ë¥¸ ì‚¬ëŒê³¼ ë‹¬ë¦¬ ì„±ì ì¸ ìƒìƒì„ ê±°ì˜ í•˜ì§€ ì•ŠëŠ”ë‹¤" },
            { num: 35, category: "ì£¼ì˜ì ê²€", text: "ì´ ë¬¸í•­ì„ ì½ê³  ìˆë‹¤ë©´ 'ì•½ê°„ ê·¸ë ‡ë‹¤'ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”", checkValue: 4 },
            { num: 36, category: "í™˜ìƒ-í˜„ì‹¤ ê²½ê³„ ëª¨í˜¸ì„±", text: "ì„±ì ìœ¼ë¡œ í¥ë¶„í•˜ë©´ í˜„ì‹¤ íŒë‹¨ë ¥ì´ íë ¤ì§„ë‹¤" },
            { num: 37, category: "ì„±ì  ì±…ì„ê° ë¶€ì¡±", text: "ì„± í”¼í•´ìë“¤ì´ ë„ˆë¬´ ê³¼ë¯¼í•˜ê²Œ ë°˜ì‘í•˜ëŠ” ê²½ìš°ë„ ìˆë‹¤ê³  ìƒê°í•œë‹¤" },
            { num: 38, category: "ì„±ì  ìƒìƒì˜ ëª°ì…ë„", text: "ì„±ì  ìƒìƒì„ í•  ë•Œ ì ì  ë” ê°•ë ¬í•´ì§„ë‹¤" },
            { num: 39, category: "ì„±ì¸ì‹ ì™œê³¡", text: "ì„±ì  ë¬¸ì œê°€ ìƒê¸°ë©´ ìœ í˜¹í•œ ìª½ì—ë„ ì±…ì„ì´ ìˆë‹¤" },
            { num: 40, category: "ì„±ì  ê´€ì‹¬ì˜ íŠ¹ì´ì„±", text: "ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ë” íŠ¹ë³„í•œ ìê·¹ì´ í•„ìš”í•˜ë‹¤" },
            { num: 41, category: "ì„±ì¶©ë™ ì¡°ì ˆ ì–´ë ¤ì›€", text: "ì„±ì¶©ë™ì„ ëŠë‚„ ë•Œ ë‹¤ë¥¸ í™œë™ìœ¼ë¡œ ì „í™˜í•˜ê¸° ì–´ë µë‹¤" },
            { num: 42, category: "ì‚¬íšŒì  ë°”ëŒì§ì„±", text: "ë‚˜ëŠ” ì‚¬íšŒì ìœ¼ë¡œ ìš©ë‚©ë˜ì§€ ì•ŠëŠ” ê²ƒì— í¥ë¯¸ë¥¼ ëŠë‚€ ì ì´ ì—†ë‹¤" },
            { num: 43, category: "í™˜ìƒ-í˜„ì‹¤ ê²½ê³„ ëª¨í˜¸ì„±", text: "ì„±ì  í™˜ìƒê³¼ í˜„ì‹¤ì„ êµ¬ë³„í•˜ëŠ” ê²ƒì´ ì–´ë ¤ìš¸ ë•Œê°€ ìˆë‹¤" },
            { num: 44, category: "ì„±ì  ì±…ì„ê° ë¶€ì¡±", text: "ì„±ì  í–‰ë™ì—ì„œ ìƒëŒ€ë°©ì˜ ê°ì •ë³´ë‹¤ ë‚´ ë§Œì¡±ì´ ìš°ì„ ì´ë‹¤" }
        ];

        // DOMì´ ë¡œë“œë˜ë©´ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            // ì„¹ì…˜ ìˆœì„œ ì„¤ì •
            sectionOrder = [
                'intro-section',
                'consent-section',
                'demo1-section',  // ì„±ë³„
                'demo2-section'   // ì—°ë ¹
            ];
            
            // ê²€ì‚¬ ë¬¸í•­ ì„¹ì…˜ ìƒì„±
            createQuestionSections();
            
            // ë‚˜ë¨¸ì§€ ì¸êµ¬í†µê³„ ì„¹ì…˜ ì¶”ê°€
            sectionOrder.push(
                'demo3-section',  // ê²°í˜¼ìƒíƒœ
                'demo4-section',  // ì—°ì• ê´€ê³„
                'demo5-section',  // í•™ë ¥
                'demo6-section',  // ì§ì—…
                'demo7-section',  // ì„±ì ì§€í–¥ì„±
                'demo8-section',  // ìƒë‹´ê²½í—˜
                'result-section'
            );
            
            // localStorageì—ì„œ ì €ì¥ëœ ë‹µë³€ ë¶ˆëŸ¬ì˜¤ê¸°
            loadAnswers();
        });

        // ê²€ì‚¬ ë¬¸í•­ ì„¹ì…˜ ìƒì„±
        function createQuestionSections() {
            const container = document.getElementById('question-sections');
            
            questions.forEach((q, index) => {
                const section = document.createElement('div');
                section.className = 'section';
                section.id = `q${q.num}-section`;
                
                section.innerHTML = `
                    <div class="question-container">
                        <div class="question-number">ë¬¸í•­ ${q.num} / ${questions.length}</div>
                        <div class="missing-indicator">âš ï¸ ì´ ë¬¸í•­ì— ì‘ë‹µí•´ì£¼ì„¸ìš”</div>
                        <div class="question-text">${q.text}</div>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="q${q.num}_1" name="q${q.num}" value="1" onchange="selectAnswer(${q.num}, 1)">
                                <label for="q${q.num}_1">ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="q${q.num}_2" name="q${q.num}" value="2" onchange="selectAnswer(${q.num}, 2)">
                                <label for="q${q.num}_2">ê·¸ë ‡ì§€ ì•Šë‹¤</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="q${q.num}_3" name="q${q.num}" value="3" onchange="selectAnswer(${q.num}, 3)">
                                <label for="q${q.num}_3">ë³´í†µì´ë‹¤</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="q${q.num}_4" name="q${q.num}" value="4" onchange="selectAnswer(${q.num}, 4)">
                                <label for="q${q.num}_4">ì•½ê°„ ê·¸ë ‡ë‹¤</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="q${q.num}_5" name="q${q.num}" value="5" onchange="selectAnswer(${q.num}, 5)">
                                <label for="q${q.num}_5">ë§¤ìš° ê·¸ë ‡ë‹¤</label>
                            </div>
                        </div>
                    </div>
                    <div class="button-group">
                        <button class="btn btn-secondary" onclick="previousSection()">ì´ì „</button>
                    </div>
                `;
                
                container.appendChild(section);
                sectionOrder.push(`q${q.num}-section`);
            });
        }

        // ë‹µë³€ ì„ íƒ
        function selectAnswer(questionNum, value) {
            answers[`q${questionNum}`] = value;
            saveAnswers();
            
            // ìë™ìœ¼ë¡œ ë‹¤ìŒ ë¬¸í•­ìœ¼ë¡œ
            setTimeout(() => {
                nextSection();
            }, 300);
        }

        // ì¸êµ¬í†µê³„ ë‹µë³€ ì €ì¥
        document.addEventListener('change', function(e) {
            if (e.target.type === 'radio' && !e.target.name.startsWith('q')) {
                answers[e.target.name] = e.target.value;
                saveAnswers();
                
                // ìë™ìœ¼ë¡œ ë‹¤ìŒìœ¼ë¡œ
                setTimeout(() => {
                    nextSection();
                }, 300);
            }
        });

        // ì„¹ì…˜ ì´ë™
        function nextSection() {
            const sections = document.querySelectorAll('.section');
            sections[currentSection].classList.remove('active');
            
            if (currentSection < sectionOrder.length - 1) {
                currentSection++;
                document.getElementById(sectionOrder[currentSection]).classList.add('active');
                window.scrollTo(0, 0);
            }
        }

        function previousSection() {
            if (currentSection > 0) {
                document.getElementById(sectionOrder[currentSection]).classList.remove('active');
                currentSection--;
                document.getElementById(sectionOrder[currentSection]).classList.add('active');
                window.scrollTo(0, 0);
            }
        }

        // ë™ì˜ í™•ì¸
        function checkConsent() {
            const consent1 = document.getElementById('consent1').checked;
            const consent2 = document.getElementById('consent2').checked;
            const consent3 = document.getElementById('consent3').checked;
            
            if (consent1 && consent2 && consent3) {
                nextSection();
            } else {
                document.getElementById('consent-alert').classList.add('show');
                setTimeout(() => {
                    document.getElementById('consent-alert').classList.remove('show');
                }, 3000);
            }
        }

        // ì™„ë£Œ ì²´í¬
        function checkCompletion() {
            const missingQuestions = [];
            const checkFailures = [];
            
            // ë¬¸í•­ ë‹µë³€ í™•ì¸
            for (let i = 1; i <= questions.length; i++) {
                if (!answers[`q${i}`]) {
                    missingQuestions.push(i);
                }
            }
            
            // ì£¼ì˜ì ê²€ ë¬¸í•­ í™•ì¸
            questions.forEach(q => {
                if (q.checkValue && answers[`q${q.num}`] && parseInt(answers[`q${q.num}`]) !== q.checkValue) {
                    checkFailures.push(q.num);
                }
            });
            
            // ì¸êµ¬í†µê³„ í™•ì¸
            const demoFields = ['gender', 'age', 'marriage', 'relationship', 'education', 'job', 'orientation', 'counseling'];
            const missingDemo = demoFields.filter(field => !answers[field]);
            
            // ëˆ„ë½ ì²˜ë¦¬
            if (missingQuestions.length > 0) {
                goToMissingQuestion(missingQuestions[0]);
            } else if (checkFailures.length > 0) {
                goToCheckFailure(checkFailures[0]);
            } else if (missingDemo.length > 0) {
                alert(`ë‹¤ìŒ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”: ${missingDemo.join(', ')}`);
            } else {
                // ëª¨ë‘ ì™„ë£Œ - ê²°ê³¼ ê³„ì‚°
                calculateResults();
            }
        }

        // ëˆ„ë½ ë¬¸í•­ìœ¼ë¡œ ì´ë™
        function goToMissingQuestion(questionNum) {
            // í˜„ì¬ ì„¹ì…˜ ìˆ¨ê¸°ê¸°
            document.getElementById(sectionOrder[currentSection]).classList.remove('active');
            
            // í•´ë‹¹ ë¬¸í•­ ì„¹ì…˜ ì°¾ê¸°
            const targetSection = `q${questionNum}-section`;
            const targetIndex = sectionOrder.indexOf(targetSection);
            
            // í•´ë‹¹ ì„¹ì…˜ìœ¼ë¡œ ì´ë™
            currentSection = targetIndex;
            const section = document.getElementById(targetSection);
            section.classList.add('active');
            section.classList.add('missing');
            
            // ìŠ¤í¬ë¡¤
            window.scrollTo(0, 0);
            
            // 3ì´ˆ í›„ í•˜ì´ë¼ì´íŠ¸ ì œê±°
            setTimeout(() => {
                section.classList.remove('missing');
            }, 3000);
        }

        // ì£¼ì˜ì ê²€ ì‹¤íŒ¨ ë¬¸í•­ìœ¼ë¡œ ì´ë™
        function goToCheckFailure(questionNum) {
            goToMissingQuestion(questionNum);
            alert('ì£¼ì˜ì ê²€ ë¬¸í•­ì…ë‹ˆë‹¤. ì§€ì‹œì— ë”°ë¼ ì‘ë‹µí•´ì£¼ì„¸ìš”.');
        }

        // ê²°ê³¼ ê³„ì‚°
        function calculateResults() {
            // ì²™ë„ë³„ ì ìˆ˜ ê³„ì‚°
            const scales = {
                "ì„±ì¸ì‹ ì™œê³¡": [],
                "ì„±ì  ìƒìƒì˜ ëª°ì…ë„": [],
                "ì„±ì  ê´€ì‹¬ì˜ íŠ¹ì´ì„±": [],
                "ì„±ì¶©ë™ ì¡°ì ˆ ì–´ë ¤ì›€": [],
                "í™˜ìƒ-í˜„ì‹¤ ê²½ê³„ ëª¨í˜¸ì„±": [],
                "ì„±ì  ì±…ì„ê° ë¶€ì¡±": []
            };
            
            questions.forEach(q => {
                if (q.category !== "ì‚¬íšŒì  ë°”ëŒì§ì„±" && q.category !== "ì£¼ì˜ì ê²€") {
                    const score = parseInt(answers[`q${q.num}`]) || 0;
                    if (scales[q.category]) {
                        scales[q.category].push(score);
                    }
                }
            });
            
            // í‰ê·  ê³„ì‚°
            const scaleScores = {};
            for (const [scale, scores] of Object.entries(scales)) {
                const avg = scores.reduce((a, b) => a + b, 0) / scores.length;
                scaleScores[scale] = avg.toFixed(1);
            }
            
            // ê²°ê³¼ ì €ì¥ (ì´ë©”ì¼ ì „ì†¡ìš©)
            lastScaleScores = scaleScores;
            
            // ì¢…í•© í‰ê°€
            const overallResult = getOverallResult(scaleScores);
            
            // íŠ¹ë³„ ê´€ì°° ì˜ì—­
            const specialObservations = getSpecialObservations(scaleScores);
            
            // ìœ„í—˜ ë¬¸í•­ ì²´í¬
            const riskItems = checkRiskItems();
            
            // ê²°ê³¼ í‘œì‹œ
            showResults(overallResult, scaleScores, specialObservations, riskItems);
            
            // Google Sheetsì— ì €ì¥
            saveToGoogleSheets();
        }

        // ì¢…í•© í‰ê°€ íŒì •
        function getOverallResult(scores) {
            const highScores = Object.values(scores).filter(s => parseFloat(s) >= 3.5).length;
            const veryHighScores = Object.values(scores).filter(s => parseFloat(s) >= 4.5).length;
            
            if (veryHighScores > 0) {
                return {
                    level: "danger",
                    icon: "ğŸ”´",
                    title: "ìœ„í—˜ - ì¦‰ì‹œ ê°œì…",
                    content: "íŠ¹ì • ì˜ì—­ì—ì„œ ì„±ì  ì¸ì‹ ë° í–‰ë™ ì¡°ì ˆì— ë§¤ìš° ë†’ì€ ìˆ˜ì¤€ì˜ ì–´ë ¤ì›€ì´ ë‚˜íƒ€ë‚˜ê³  ìˆìŠµë‹ˆë‹¤. ì‹ ì†íˆ ì „ë¬¸ì  ë„ì›€ì´ í•„ìš”í•œ ìƒíƒœì…ë‹ˆë‹¤.",
                    recommendation: "ê°€ê¹Œìš´ ì •ì‹ ê±´ê°•ë³µì§€ì„¼í„° ì¦‰ì‹œ ì—°ë½, ì‘ê¸‰ ìƒí™© ì‹œ 1577-0199 (ì •ì‹ ê±´ê°• ìœ„ê¸°ìƒë‹´), ì´ë²ˆ ì£¼ ë‚´ë¡œ ì „ë¬¸ê°€ ìƒë‹´ í•„ìˆ˜"
                };
            } else if (highScores >= 3) {
                return {
                    level: "warning",
                    icon: "ğŸŸ ",
                    title: "ê²½ê³  - ìƒë‹´ ê¶Œì¥",
                    content: "ì—¬ëŸ¬ ì˜ì—­ì—ì„œ ë™ì‹œì— ì£¼ì˜ ì‹ í˜¸ê°€ ë‚˜íƒ€ë‚˜ê³  ìˆìŠµë‹ˆë‹¤. ì‹¬ì¸µì ì¸ ìê¸° íƒìƒ‰ ë˜ëŠ” ì „ë¬¸ê°€ ìƒë‹´ì„ ê¶Œì¥í•©ë‹ˆë‹¤.",
                    recommendation: "ì „ë¬¸ ìƒë‹´ í•„ìš”, ë¯¸ë£¨ì§€ ë§ê³  ë¹ ë¥¸ ì‹œì¼ ë‚´ ìƒë‹´ ì˜ˆì•½"
                };
            } else if (highScores >= 1) {
                return {
                    level: "caution",
                    icon: "ğŸŸ¡",
                    title: "ì£¼ì˜ - ê´€ì°° í•„ìš”",
                    content: "íŠ¹ì • ì˜ì—­ì—ì„œ ê°œì„ ì´ í•„ìš”í•œ ë¶€ë¶„ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¹ì¥ ë¬¸ì œê°€ ìˆëŠ” ê²ƒì€ ì•„ë‹ˆì§€ë§Œ, ìê¸° ì ê²€ê³¼ ì˜ˆë°©ì  ì¸ì‹ì´ í•„ìš”í•©ë‹ˆë‹¤.",
                    recommendation: "ë†’ê²Œ ë‚˜ì˜¨ ì˜ì—­ì„ ì¤‘ì‹¬ìœ¼ë¡œ ìê¸° ê´€ì°°, í•„ìš”ì‹œ ìƒë‹´ ê³ ë ¤"
                };
            } else {
                return {
                    level: "good",
                    icon: "ğŸŸ¢",
                    title: "ì•ˆì • - ê±´ê°•í•œ ìƒíƒœ",
                    content: "ì „ë°˜ì ìœ¼ë¡œ ê±´ê°•í•œ ì„±ì  ì¸ì‹ê³¼ íƒœë„ë¥¼ ë³´ì´ë©°, ììœ¨ì ì¸ í†µì œë ¥ì´ ì–‘í˜¸í•œ ìƒíƒœì…ë‹ˆë‹¤. í˜„ì¬ì˜ ê±´ê°•í•œ ìƒíƒœë¥¼ ìœ ì§€í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.",
                    recommendation: "íŒŒíŠ¸ë„ˆì™€ì˜ ì§€ì†ì ì¸ ì†Œí†µ, ì •ê¸°ì ì¸ ìê¸° ì„±ì°°, ê±´ê°•í•œ ê´€ê³„ ìœ ì§€ë¥¼ ìœ„í•œ ë…¸ë ¥ ì§€ì†"
                };
            }
        }

        // íŠ¹ë³„ ê´€ì°° ì˜ì—­ ì²´í¬
        function getSpecialObservations(scores) {
            const observations = [];
            
            // ìœ„í—˜ ì¡°í•© ì²´í¬ (4.0 ì´ìƒ)
            if (parseFloat(scores["ì„±ì¶©ë™ ì¡°ì ˆ ì–´ë ¤ì›€"]) >= 4.0 && parseFloat(scores["ì„±ì¸ì‹ ì™œê³¡"]) >= 4.0) {
                observations.push({
                    type: "ë§‰ ë‚˜ê°€ëŠ” ì°©ê°í˜•",
                    detail: "(ì¶©ë™ ì¡°ì ˆ ì–´ë ¤ì›€ + ì„±ì¸ì‹ ì™œê³¡)",
                    advice: "í™•ì‹¤í•˜ì§€ ì•Šìœ¼ë©´ ê¼­ ë¬¼ì–´ë³´ê¸°. ìƒëŒ€ì˜ ë§ê³¼ í‘œì •, ëª¸ì§“ê¹Œì§€ ê°™ì´ ì½ëŠ” ì—°ìŠµì„ í•´ë³´ì„¸ìš”."
                });
            }
            
            if (parseFloat(scores["ì„±ì¶©ë™ ì¡°ì ˆ ì–´ë ¤ì›€"]) >= 4.0 && parseFloat(scores["í™˜ìƒ-í˜„ì‹¤ ê²½ê³„ ëª¨í˜¸ì„±"]) >= 4.0) {
                observations.push({
                    type: "ìƒìƒ ë°”ë¡œ ì‹¤í–‰í˜•",
                    detail: "(ì¶©ë™ ì¡°ì ˆ ì–´ë ¤ì›€ + í™˜ìƒ-í˜„ì‹¤ ê²½ê³„ ëª¨í˜¸)",
                    advice: "í™˜ìƒì€ í™˜ìƒìœ¼ë¡œë§Œ. ì¶©ë™ì´ ì˜¬ ë•ŒëŠ” ì ì‹œ ìë¦¬ë¥¼ ë– ë‚˜ ì‹¬í˜¸í¡í•˜ì„¸ìš”."
                });
            }
            
            if (parseFloat(scores["ì„±ì  ê´€ì‹¬ì˜ íŠ¹ì´ì„±"]) >= 4.0 && parseFloat(scores["ì„±ì¶©ë™ ì¡°ì ˆ ì–´ë ¤ì›€"]) >= 4.0) {
                observations.push({
                    type: "ë³„ë‚œ ì·¨í–¥ ê³ ì§‘í˜•",
                    detail: "(ì„±ì  ê´€ì‹¬ íŠ¹ì´ì„± + ì¶©ë™ ì¡°ì ˆ ì–´ë ¤ì›€)",
                    advice: "í‰ë²”í•œ ìŠ¤í‚¨ì‹­ë„ ì¶©ë¶„íˆ ì¢‹ì•„ìš”. ì¼ë°˜ì ì¸ ì¹œë°€ê°ì„ ì¦ê¸°ëŠ” ì—°ìŠµì„ í•´ë³´ì„¸ìš”."
                });
            }
            
            if (parseFloat(scores["ì„±ì  ìƒìƒì˜ ëª°ì…ë„"]) >= 4.0 && parseFloat(scores["í™˜ìƒ-í˜„ì‹¤ ê²½ê³„ ëª¨í˜¸ì„±"]) >= 4.0) {
                observations.push({
                    type: "ìƒìƒì— í‘¹ ë¹ ì§„í˜•",
                    detail: "(ì„±ì  ìƒìƒ ëª°ì… + í™˜ìƒ-í˜„ì‹¤ ê²½ê³„ ëª¨í˜¸)",
                    advice: "í•˜ë£¨ 30ë¶„ë§Œ ìƒìƒí•˜ê¸°. ì•ŒëŒì„ ë§ì¶°ë‘ê³  í˜„ì‹¤ë¡œ ëŒì•„ì˜¤ì„¸ìš”."
                });
            }
            
            if (parseFloat(scores["ì„±ì¸ì‹ ì™œê³¡"]) >= 4.0 && parseFloat(scores["ì„±ì  ì±…ì„ê° ë¶€ì¡±"]) >= 4.0) {
                observations.push({
                    type: "ë‚˜ë§Œ ëª°ëì–´ìš”í˜•",
                    detail: "(ì„±ì¸ì‹ ì™œê³¡ + ì„±ì  ì±…ì„ê° ë¶€ì¡±)",
                    advice: "ë‚´ í–‰ë™ì€ ë‚´ ì±…ì„. ìƒëŒ€ë°© ì…ì¥ì—ì„œ í•œ ë²ˆ ë” ìƒê°í•´ë³´ì„¸ìš”."
                });
            }
            
            return observations;
        }

        // ìœ„í—˜ ë¬¸í•­ ì²´í¬
        function checkRiskItems() {
            const riskQuestions = [2, 6, 11, 19, 28];
            const risks = [];
            
            riskQuestions.forEach(qNum => {
                if (parseInt(answers[`q${qNum}`]) >= 4) {
                    const q = questions.find(q => q.num === qNum);
                    let message = "";
                    
                    switch(qNum) {
                        case 2:
                            message = "ìˆ  ë§ˆì‹  ìƒíƒœì—ì„œì˜ ë™ì˜ëŠ” ë²•ì ìœ¼ë¡œë„ ì¸ì •ë˜ì§€ ì•Šì•„ìš”. ë§‘ì€ ì •ì‹ ì¼ ë•Œ, ëª…í™•í•œ ì˜ì‚¬ë¡œë§Œ í–‰ë™í•˜ì„¸ìš”.";
                            break;
                        case 6:
                            message = "ì‹¤í–‰ ì „ì— 'ì´ í–‰ë™ì´ ì§„ì§œ ê´œì°®ì„ê¹Œ?'ë¥¼ ìŠ¤ìŠ¤ë¡œì—ê²Œ ê¼­ ë¬¼ì–´ë³´ì„¸ìš”. ìƒìƒì€ ë¨¸ë¦¿ì†ì—ì„œ ëë‚´ë„ ì¶©ë¶„í•´ìš”.";
                            break;
                        case 11:
                            message = "'ì§€ê¸ˆ ë°”ë¡œ í–‰ë™í•´ì•¼ í•˜ë‚˜?'ë¥¼ í•œë²ˆ ë©ˆì¶° ìƒê°í•´ë³´ì„¸ìš”. ì°¬ë¬¼ ìƒ¤ì›Œ, ìë¦¬ í”¼í•˜ê¸° ê°™ì€ ë°©ë²•ë„ ë„ì›€ì´ ë¼ìš”.";
                            break;
                        case 19:
                            message = "ë°˜ë³µë˜ëŠ” í›„íšŒëŠ” íŒ¨í„´ì„ ë°”ê¿”ì•¼ í•œë‹¤ëŠ” ì‹ í˜¸ì˜ˆìš”. ì–¸ì œ, ì–´ë””ì„œ, ì–´ë–¤ ìƒí™©ì—ì„œ ì¶©ë™ì´ ìƒê¸°ëŠ”ì§€ ê¸°ë¡í•˜ê³ , ê·¸ ìƒí™©ì„ ë¯¸ë¦¬ í”¼í•˜ì„¸ìš”.";
                            break;
                        case 28:
                            message = "í–‰ë™ì˜ ê²°ê³¼ëŠ” ë˜ëŒë¦´ ìˆ˜ ì—†ì–´ìš”. ë²•ì  ë¬¸ì œ, ê´€ê³„ íŒŒê´´, ìƒëŒ€ë°©ì˜ ìƒì²˜ ë“± í˜„ì‹¤ì˜ ê²°ê³¼ë¥¼ ë¨¼ì € ìƒê°í•´ë³´ì„¸ìš”.";
                            break;
                    }
                    
                    risks.push({
                        question: q.text,
                        message: message
                    });
                }
            });
            
            return risks;
        }

        // ê²°ê³¼ í‘œì‹œ
        function showResults(overall, scores, observations, risks) {
            // ì¢…í•© í‰ê°€
            document.getElementById('overall-result').innerHTML = `
                <div class="result-header">
                    <div class="result-icon">${overall.icon}</div>
                    <div>
                        <h2>${overall.title}</h2>
                        <p>${overall.content}</p>
                        <p style="margin-top: 10px; font-weight: bold;">${overall.recommendation}</p>
                    </div>
                </div>
            `;
            
            // ì²™ë„ë³„ ì ìˆ˜
            const scaleResults = document.getElementById('scale-results');
            scaleResults.innerHTML = '';
            
            for (const [scale, score] of Object.entries(scores)) {
                const level = getScaleLevel(parseFloat(score));
                const interpretation = getScaleInterpretation(scale, level);
                
                scaleResults.innerHTML += `
                    <div class="scale-item">
                        <div class="scale-header">
                            <span class="scale-name">${scale}</span>
                            <span class="scale-score">${score}ì </span>
                        </div>
                        <div class="scale-bar-container">
                            <div class="scale-bar ${level}" style="width: ${(score / 5) * 100}%"></div>
                        </div>
                        <p style="margin-top: 10px; color: #666; font-size: 14px;">${interpretation}</p>
                    </div>
                `;
            }
            
            // íŠ¹ë³„ ê´€ì°° ì˜ì—­
            if (observations.length > 0 || risks.length > 0) {
                const obsDiv = document.getElementById('special-observation');
                obsDiv.style.display = 'block';
                
                let obsContent = '';
                
                if (observations.length > 0) {
                    observations.forEach(obs => {
                        obsContent += `
                            <div class="observation-item">
                                <div class="observation-type">${obs.type} ${obs.detail}</div>
                                <p>: ${obs.advice}</p>
                            </div>
                        `;
                    });
                }
                
                if (risks.length > 0) {
                    obsContent += '<h4 style="margin-top: 20px; color: #e74c3c;">ì£¼ì˜ê°€ í•„ìš”í•œ ì‘ë‹µ</h4>';
                    risks.forEach(risk => {
                        obsContent += `
                            <div class="observation-item" style="background: #ffe6e6;">
                                <p style="font-size: 14px; margin-bottom: 5px;">"${risk.question}"</p>
                                <p style="color: #e74c3c;">â€¢ ${risk.message}</p>
                            </div>
                        `;
                    });
                }
                
                document.getElementById('observation-content').innerHTML = obsContent;
            }
            
            // ê²°ê³¼ ì„¹ì…˜ í‘œì‹œ
            document.getElementById(sectionOrder[currentSection]).classList.remove('active');
            document.getElementById('result-section').classList.add('active');
            window.scrollTo(0, 0);
        }

        // ì²™ë„ ìˆ˜ì¤€ íŒì •
        function getScaleLevel(score) {
            if (score <= 2.5) return 'good';
            if (score <= 3.5) return 'caution';
            if (score <= 4.4) return 'warning';
            return 'danger';
        }

        // ì²™ë„ë³„ í•´ì„ (ê°„ë‹¨ ë²„ì „)
        function getScaleInterpretation(scale, level) {
            const interpretations = {
                "ì„±ì¸ì‹ ì™œê³¡": {
                    good: "ì„±ì  ìƒí™©ì—ì„œ ìƒëŒ€ë°©ì˜ ì˜ì‚¬ë¥¼ ì˜ íŒŒì•…í•˜ê³  ì¡´ì¤‘í•©ë‹ˆë‹¤. ë™ì˜ì˜ ì¤‘ìš”ì„±ì„ ì´í•´í•˜ê³  ìˆìŠµë‹ˆë‹¤.",
                    caution: "ë•Œë•Œë¡œ ìƒëŒ€ë°©ì˜ ì‹ í˜¸ë¥¼ ìì˜ì ìœ¼ë¡œ í•´ì„í•˜ëŠ” ê²½í–¥ì´ ìˆìŠµë‹ˆë‹¤. ëª…í™•í•œ ì˜ì‚¬ì†Œí†µì´ í•„ìš”í•©ë‹ˆë‹¤.",
                    warning: "ìƒëŒ€ë°©ì˜ ë™ì˜ì™€ ê±°ë¶€ì˜ ì‹ í˜¸ë¥¼ ìì£¼ ì˜¤í•´í•©ë‹ˆë‹¤. ìƒëŒ€ë°©ì˜ ì…ì¥ì„ ì´í•´í•˜ëŠ” ì—°ìŠµì´ í•„ìš”í•©ë‹ˆë‹¤.",
                    danger: "ì„±ì  ìƒí™©ì— ëŒ€í•œ ì¸ì‹ì´ ë§¤ìš° ì™œê³¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì „ë¬¸ê°€ì˜ ë„ì›€ì´ ì‹œê¸‰í•©ë‹ˆë‹¤."
                },
                "ì„±ì  ìƒìƒì˜ ëª°ì…ë„": {
                    good: "ì„±ì  ìƒìƒê³¼ ì¼ìƒìƒí™œì˜ ê· í˜•ì„ ì˜ ìœ ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤.",
                    caution: "ì„±ì  í™˜ìƒì— ë¹ ì§€ëŠ” ì‹œê°„ì´ ëŠ˜ì–´ë‚˜ê³  ìˆìŠµë‹ˆë‹¤. ì¼ìƒ í™œë™ì— ë” ì§‘ì¤‘í•´ë³´ì„¸ìš”.",
                    warning: "ì„±ì  ìƒìƒì´ ì¼ìƒì„ ë°©í•´í•  ì •ë„ë¡œ ê³¼ë„í•©ë‹ˆë‹¤. í˜„ì‹¤ í™œë™ì„ ëŠ˜ë ¤ì•¼ í•©ë‹ˆë‹¤.",
                    danger: "ì„±ì  í™˜ìƒì— ì§€ë‚˜ì¹˜ê²Œ ëª°ì…í•˜ì—¬ ì¼ìƒìƒí™œì— ì‹¬ê°í•œ ì§€ì¥ì´ ìˆìŠµë‹ˆë‹¤."
                },
                "ì„±ì  ê´€ì‹¬ì˜ íŠ¹ì´ì„±": {
                    good: "ì¼ë°˜ì ì¸ ë²”ìœ„ì˜ ì„±ì  ê´€ì‹¬ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.",
                    caution: "íŠ¹ì •í•œ ì¡°ê±´ì´ë‚˜ ìƒí™©ì„ ì„ í˜¸í•˜ëŠ” ê²½í–¥ì´ ìˆìŠµë‹ˆë‹¤. ì¼ë°˜ì ì¸ ì¹œë°€ê°ì—ì„œ ë§Œì¡±ì„ ëŠë¼ê¸° ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
                    warning: "ë§¤ìš° íŠ¹ìˆ˜í•œ ì¡°ê±´ì—ë§Œ ê´€ì‹¬ì„ ê°€ì§‘ë‹ˆë‹¤. ì„±ì  ê´€ì‹¬ì˜ í­ì„ ë„“í í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤.",
                    danger: "ê·¹ë„ë¡œ ì œí•œì ì´ê³  íŠ¹ì´í•œ ì„±ì  ê´€ì‹¬ìœ¼ë¡œ ì¸í•´ ì–´ë ¤ì›€ì´ ì˜ˆìƒë©ë‹ˆë‹¤."
                },
                "ì„±ì¶©ë™ ì¡°ì ˆ ì–´ë ¤ì›€": {
                    good: "ì„±ì¶©ë™ì„ ì ì ˆíˆ ì¸ì‹í•˜ê³  ì¡°ì ˆí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
                    caution: "ë•Œë•Œë¡œ ì¶©ë™ ì¡°ì ˆì— ì–´ë ¤ì›€ì„ ê²ªìŠµë‹ˆë‹¤. ëŒ€ì²˜ ë°©ë²•ì„ ìµíˆë©´ ë„ì›€ì´ ë©ë‹ˆë‹¤.",
                    warning: "ì„±ì¶©ë™ ì¡°ì ˆì— ì–´ë ¤ì›€ì„ ìì£¼ ê²ªê³  ìˆìŠµë‹ˆë‹¤. ìŠ¤ìŠ¤ë¡œ ê´€ë¦¬ ë°©ë²•ì„ ìµíˆê±°ë‚˜ ë„ì›€ì„ ë°›ìœ¼ë©´ ê°œì„ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
                    danger: "ì¶©ë™ ì¡°ì ˆì´ ë§¤ìš° ì–´ë ¤ìš´ ìƒíƒœì´ë©°, ë¶€ì ì ˆí•œ í–‰ë™ìœ¼ë¡œ ì´ì–´ì§ˆ ìš°ë ¤ê°€ ìˆìŠµë‹ˆë‹¤."
                },
                "í™˜ìƒ-í˜„ì‹¤ ê²½ê³„ ëª¨í˜¸ì„±": {
                    good: "í™˜ìƒê³¼ í˜„ì‹¤ì„ ëª…í™•íˆ êµ¬ë¶„í•˜ê³  ìˆìŠµë‹ˆë‹¤.",
                    caution: "ê°€ë” í™˜ìƒê³¼ í˜„ì‹¤ì˜ ê²½ê³„ê°€ ë¶„ëª…í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",
                    warning: "í™˜ìƒê³¼ í˜„ì‹¤ì˜ ê²½ê³„ê°€ ëª¨í˜¸í•´ì§€ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤. í˜„ì‹¤ ì¸ì‹ í›ˆë ¨ì´ í•„ìš”í•©ë‹ˆë‹¤.",
                    danger: "í™˜ìƒê³¼ í˜„ì‹¤ì„ ìì£¼ í˜¼ë™í•˜ë©°, ì •í™•í•œ í˜„ì‹¤ ì¸ì‹ì„ ìœ„í•œ ì „ë¬¸ì  ê°œì…ì´ ê¶Œì¥ë©ë‹ˆë‹¤."
                },
                "ì„±ì  ì±…ì„ê° ë¶€ì¡±": {
                    good: "ì„±ì  í–‰ë™ì— ëŒ€í•œ ì±…ì„ê°ê³¼ ìœ¤ë¦¬ ì˜ì‹ì„ ê°–ì¶”ê³  ìˆìŠµë‹ˆë‹¤.",
                    caution: "ë•Œë•Œë¡œ ì±…ì„ì„ íšŒí”¼í•˜ë ¤ëŠ” ê²½í–¥ì´ ìˆìŠµë‹ˆë‹¤. ì„±ìˆ™í•œ íƒœë„ê°€ í•„ìš”í•©ë‹ˆë‹¤.",
                    warning: "ì„±ì  í–‰ë™ì˜ ê²°ê³¼ë¥¼ ê³ ë ¤í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì±…ì„ê° êµìœ¡ì´ í•„ìš”í•©ë‹ˆë‹¤.",
                    danger: "ì„±ì  ì±…ì„ê°ì´ ë§¤ìš° ë¶€ì¡±í•˜ì—¬ ìì‹ ê³¼ íƒ€ì¸ì—ê²Œ í•´ë¥¼ ë¼ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
                }
            };
            
            return interpretations[scale][level];
        }

        // ì´ë©”ì¼ ì „ì†¡
        function sendDetailedResult() {
            const email = document.getElementById('email-input').value;
            if (!email || !email.includes('@')) {
                alert('ì˜¬ë°”ë¥¸ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (typeof emailjs === 'undefined') {
                alert('ì´ë©”ì¼ ì„œë¹„ìŠ¤ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            document.getElementById('email-loading').style.display = 'block';
            
            // ìƒì„¸ ê²°ê³¼ ìƒì„±
            const detailedResult = generateDetailedResult();
            
            // EmailJSë¡œ ì „ì†¡
            emailjs.send("service_idzskep", "template_pqvaobm", {
                to_email: email,
                ...detailedResult  // ëª¨ë“  ê²°ê³¼ ë°ì´í„° ì „ë‹¬
            }).then(function(response) {
                document.getElementById('email-loading').style.display = 'none';
                document.getElementById('email-success').classList.add('show');
                console.log('ì´ë©”ì¼ ì „ì†¡ ì„±ê³µ:', response);
            }, function(error) {
                document.getElementById('email-loading').style.display = 'none';
                document.getElementById('email-error').classList.add('show');
                console.error('ì´ë©”ì¼ ì „ì†¡ ì‹¤íŒ¨:', error);
            });
        }

        // ìƒì„¸ ê²°ê³¼ ìƒì„±
        function generateDetailedResult() {
            const result = {
                user_name: answers.gender === 'ë‚¨ì„±' ? 'ì„ ìƒë‹˜' : answers.gender === 'ì—¬ì„±' ? 'ì„ ìƒë‹˜' : 'ê³ ê°ë‹˜',
                test_date: new Date().toLocaleString('ko-KR'),
                overall_level: '',
                overall_content: '',
                overall_recommendation: '',
                scale_results: '',
                special_observations: '',
                detailed_interpretations: ''
            };
            
            // ì´ë¯¸ ê³„ì‚°ëœ ì ìˆ˜ ì‚¬ìš©
            const scales = lastScaleScores;
            const overall = getOverallResult(scales);
            const observations = getSpecialObservations(scales);
            
            // ì¢…í•© í‰ê°€
            result.overall_level = overall.icon + ' ' + overall.title;
            result.overall_content = overall.content;
            result.overall_recommendation = overall.recommendation;
            
            // ì²™ë„ë³„ ê²°ê³¼ HTML
            let scaleHTML = '';
            for (const [scale, score] of Object.entries(scales)) {
                const level = getScaleLevel(parseFloat(score));
                const levelText = level === 'good' ? 'ì–‘í˜¸' : level === 'caution' ? 'ì£¼ì˜' : level === 'warning' ? 'ì§‘ì¤‘ê´€ë¦¬' : 'ì¦‰ì‹œê°œì…';
                const levelColor = level === 'good' ? 'good' : level === 'caution' ? 'caution' : level === 'warning' ? 'warning' : 'danger';
                
                scaleHTML += `
                    <div class="scale-item">
                        <strong>${scale}</strong>: ${score}ì  - <span class="${levelColor}">${levelText}</span><br>
                        <small>${getScaleInterpretation(scale, level)}</small>
                    </div>
                `;
            }
            result.scale_results = scaleHTML;
            
            // íŠ¹ë³„ ê´€ì°° ì˜ì—­
            if (observations.length > 0) {
                let obsHTML = '';
                observations.forEach(obs => {
                    obsHTML += `
                        <div style="margin: 10px 0;">
                            <strong>${obs.type}</strong> ${obs.detail}<br>
                            <em>${obs.advice}</em>
                        </div>
                    `;
                });
                result.special_observations = obsHTML;
            }
            
            // ìƒì„¸ í•´ì„ ìƒì„±
            result.detailed_interpretations = generateDetailedInterpretations(scales);
            
            return result;
        }

        
        // ìƒì„¸ í•´ì„ ìƒì„±
        function generateDetailedInterpretations(scales) {
            let html = '';
            
            for (const [scale, score] of Object.entries(scales)) {
                const level = getScaleLevel(parseFloat(score));
                const detailedInfo = getDetailedScaleInfo(scale, level);
                
                html += `
                    <div style="margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                        <h3>${scale} (${score}ì )</h3>
                        <p><strong>ìƒíƒœ:</strong> ${detailedInfo.status}</p>
                        <p><strong>í•µì‹¬ ë©”ì‹œì§€:</strong> ${detailedInfo.core}</p>
                        <p><strong>ì‹¤ì²œ ê³¼ì œ:</strong></p>
                        <ul>${detailedInfo.tasks}</ul>
                    </div>
                `;
            }
            
            return html;
        }
        
        // ìƒì„¸ ì²™ë„ ì •ë³´
        function getDetailedScaleInfo(scale, level) {
            const info = {
                "ì„±ì¸ì‹ ì™œê³¡": {
                    good: {
                        status: "ìƒëŒ€ë°©ì˜ ì˜ì‚¬ë¥¼ ì •í™•íˆ íŒŒì•…í•˜ê³  ì¡´ì¤‘í•©ë‹ˆë‹¤. ë™ì˜ì˜ ì¤‘ìš”ì„±ì„ ì˜ ì´í•´í•˜ê³  ìˆìœ¼ë©°, ê±´ê°•í•œ ê²½ê³„ë¥¼ ìœ ì§€í•©ë‹ˆë‹¤.",
                        core: "ëª…í™•í•œ ì†Œí†µìœ¼ë¡œ ì„œë¡œë¥¼ ì¡´ì¤‘í•©ë‹ˆë‹¤",
                        tasks: "<li>ë¹„ì–¸ì–´ì  ì‹ í˜¸ë„ ì„¸ì‹¬íˆ ê´€ì°°í•˜ê¸°</li><li>ìƒëŒ€ë°©ì˜ í¸ì•ˆí•¨ ìš°ì„ ì‹œí•˜ê¸°</li><li>ì¼ìƒì—ì„œë„ ê²½ì²­ ìŠµê´€ ìœ ì§€í•˜ê¸°</li>"
                    },
                    caution: {
                        status: "ë•Œë•Œë¡œ ìƒëŒ€ë°©ì˜ ì‹ í˜¸ë¥¼ ìì˜ì ìœ¼ë¡œ í•´ì„í•˜ëŠ” ê²½í–¥ì´ ìˆìŠµë‹ˆë‹¤. íŠ¹íˆ ì• ë§¤í•œ ìƒí™©ì—ì„œ ìì‹ ì—ê²Œ ìœ ë¦¬í•˜ê²Œ í•´ì„í•  ìœ„í—˜ì´ ìˆìŠµë‹ˆë‹¤.",
                        core: "í™•ì‹¤í•˜ì§€ ì•Šìœ¼ë©´ ë¬¼ì–´ë³´ì„¸ìš”",
                        tasks: "<li>'ê´œì°®ì•„?'ê°€ ì•„ë‹Œ 'í•˜ê³  ì‹¶ì–´?' ì§ˆë¬¸í•˜ê¸°</li><li>ê±°ì ˆì„ ìì—°ìŠ¤ëŸ½ê²Œ ë°›ì•„ë“¤ì´ê¸° ì—°ìŠµ</li><li>ì¶”ì¸¡ ëŒ€ì‹  í™•ì¸í•˜ëŠ” ìŠµê´€ ë§Œë“¤ê¸°</li>"
                    },
                    warning: {
                        status: "ë™ì˜ì™€ ê±°ë¶€ì˜ ì‹ í˜¸ë¥¼ ìì£¼ ì˜¤í•´í•˜ë©°, ìƒëŒ€ë°©ì˜ ë¶ˆí¸í•¨ì„ ì•Œì•„ì°¨ë¦¬ì§€ ëª»í•©ë‹ˆë‹¤.",
                        core: "ë‹¹ì‹ ì˜ í•´ì„ì´ í‹€ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤",
                        tasks: "<li>ëª¨ë“  ì„±ì  ìƒí™©ì—ì„œ ëª…ì‹œì  ë™ì˜ êµ¬í•˜ê¸°</li><li>ìƒëŒ€ë°© ì…ì¥ ì¼ê¸° ì“°ê¸° (ì£¼ 3íšŒ)</li><li>ì„±ì¸ì§€ ê°ìˆ˜ì„± êµìœ¡ ì°¸ì—¬</li>"
                    },
                    danger: {
                        status: "ì„±ì  ìƒí™©ì— ëŒ€í•œ ì¸ì‹ì´ ì‹¬ê°í•˜ê²Œ ì™œê³¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤.",
                        core: "ì§€ê¸ˆ ë‹¹ì¥ ë„ì›€ì´ í•„ìš”í•©ë‹ˆë‹¤",
                        tasks: "<li>ì¦‰ì‹œ ì „ë¬¸ê°€ ìƒë‹´ ì˜ˆì•½</li><li>ëª¨ë“  ì„±ì  ì ‘ê·¼ ì¤‘ë‹¨</li><li>ì¸ì§€í–‰ë™ì¹˜ë£Œ í”„ë¡œê·¸ë¨ ë“±ë¡</li>"
                    }
                }
                // ë‹¤ë¥¸ ì²™ë„ë“¤ë„ ì¶”ê°€...
            };
            
            // í•´ë‹¹ ì²™ë„ì™€ ë ˆë²¨ì˜ ì •ë³´ ë°˜í™˜
            return info[scale] && info[scale][level] ? info[scale][level] : {
                status: "ì •ë³´ë¥¼ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.",
                core: "ì „ë¬¸ê°€ì™€ ìƒë‹´í•˜ì„¸ìš”.",
                tasks: "<li>ì „ë¬¸ê°€ ìƒë‹´ ê¶Œì¥</li>"
            };
        }

        // Google Sheets ì €ì¥
        function saveToGoogleSheets() {
            // Google Apps Script URLì´ ì œê³µë˜ë©´ ì•„ë˜ ì£¼ì„ í•´ì œí•˜ê³  URL ì…ë ¥
            /*
            const scriptURL = 'YOUR_GOOGLE_APPS_SCRIPT_URL';
            
            // ë°ì´í„° ì¤€ë¹„
            const data = {
                timestamp: new Date().toISOString(),
                ...answers
            };
            
            fetch(scriptURL, {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            })
            .then(response => console.log('ë°ì´í„° ì €ì¥ ì„±ê³µ'))
            .catch(error => console.error('ë°ì´í„° ì €ì¥ ì‹¤íŒ¨:', error));
            */
            
            console.log('Google Sheets ì €ì¥ ê¸°ëŠ¥ì€ URL ì„¤ì • í›„ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.');
        }
        
        // ê²°ê³¼ ë‹¤ìš´ë¡œë“œ
        function downloadResults() {
            const resultText = generateTextResult();
            const blob = new Blob([resultText], { type: 'text/plain;charset=utf-8' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ì„±ê±´ê°•ê²€ì‚¬ê²°ê³¼_${new Date().toLocaleDateString('ko-KR').replace(/\./g, '')}.txt`;
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
        }
        
        // í…ìŠ¤íŠ¸ ê²°ê³¼ ìƒì„±
        function generateTextResult() {
            const result = generateDetailedResult();
            let text = 'ì„±ê±´ê°• ìê°€ì§„ë‹¨ ê²€ì‚¬ ê²°ê³¼\n';
            text += '=' .repeat(50) + '\n\n';
            text += `ê²€ì‚¬ì¼ì‹œ: ${result.test_date}\n\n`;
            
            text += 'ã€ì¢…í•© í‰ê°€ã€‘\n';
            text += result.overall_level + '\n';
            text += result.overall_content + '\n';
            text += 'ê¶Œì¥ì‚¬í•­: ' + result.overall_recommendation + '\n\n';
            
            text += 'ã€ì˜ì—­ë³„ ê²°ê³¼ã€‘\n';
            for (const [scale, score] of Object.entries(lastScaleScores)) {
                const level = getScaleLevel(parseFloat(score));
                text += `${scale}: ${score}ì \n`;
                text += `- ${getScaleInterpretation(scale, level)}\n\n`;
            }
            
            if (result.special_observations) {
                text += 'ã€íŠ¹ë³„ ê´€ì°° ì˜ì—­ã€‘\n';
                const temp = document.createElement('div');
                temp.innerHTML = result.special_observations;
                text += temp.textContent + '\n\n';
            }
            
            text += '-' .repeat(50) + '\n';
            text += 'ë³¸ ê²€ì‚¬ëŠ” ìê¸°ì´í•´ë¥¼ ë•ëŠ” ì°¸ê³ ìë£Œì…ë‹ˆë‹¤.\n';
            text += 'ì „ë¬¸ì  ë„ì›€ì´ í•„ìš”í•œ ê²½ìš° ì •ì‹ ê±´ê°• ì „ë¬¸ê°€ì™€ ìƒë‹´í•˜ì„¸ìš”.\n';
            text += 'ì •ì‹ ê±´ê°• ìœ„ê¸°ìƒë‹´: 1577-0199\n';
            
            return text;
        }

        // localStorage ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸° (ì•ˆì „í•˜ê²Œ ì²˜ë¦¬)
        function saveAnswers() {
            try {
                if (typeof(Storage) !== "undefined" && window.localStorage) {
                    localStorage.setItem('sexualHealthAnswers', JSON.stringify(answers));
                }
            } catch (e) {
                console.log('localStorageë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', e.message);
            }
        }

        function loadAnswers() {
            try {
                if (typeof(Storage) !== "undefined" && window.localStorage) {
                    const saved = localStorage.getItem('sexualHealthAnswers');
                    if (saved) {
                        answers = JSON.parse(saved);
                        // ì €ì¥ëœ ë‹µë³€ ë³µì›
                        for (const [key, value] of Object.entries(answers)) {
                            const input = document.querySelector(`input[name="${key}"][value="${value}"]`);
                            if (input) input.checked = true;
                        }
                    }
                }
            } catch (e) {
                console.log('localStorageë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', e.message);
            }
        }
    </script>
</body>
</html>
